(function(b){function u(b){for(var c=1;c<arguments.length;c++)b=b.replace("%"+(c-1),arguments[c]);return b}function I(f,c){var d=b("img.visible",f),e,h=null,m=null,k=null,n=null,l=null,r=null,v,D=0,y,z,E=0,F=0,p=0,q=0,G=0,B,C,A=this,H;setTimeout(function(){if(null===m){var d=f.width();f.parent().append(u('<div style="width:%0px;position:absolute;top:75%;left:%1px;text-align:center" class="cloud-zoom-loading" >Loading...</div>',d/3,d/2-d/6));b("cloud-zoom-loading",f.parent()).css("opacity",.5)}},200);
this.removeBits=function(){k&&(k.remove(),k=null);n&&(n.remove(),n=null);l&&(l.remove(),l=null);null!==r&&(r.remove(),r=null);b(".cloud-zoom-loading",f.parent()).remove()};this.destroy=function(){f.data("zoom",null);m&&(m.unbind(),m.remove(),m=null);h&&(h.remove(),h=null);this.removeBits()};this.fadedOut=function(){h&&(h.remove(),h=null);this.removeBits()};this.controlLoop=function(){if(k){var b=B-d.offset().left-.5*y>>0,g=C-d.offset().top-.5*z>>0;0>b?b=0:b>d.outerWidth()-y&&(b=d.outerWidth()-y);
0>g?g=0:g>d.outerHeight()-z&&(g=d.outerHeight()-z);k.css({left:b,top:g});k.css("background-position",-b+"px "+-g+"px");E=b/d.outerWidth()*v.width>>0;F=g/d.outerHeight()*v.height>>0;q+=(E-q)/c.smoothMove;p+=(F-p)/c.smoothMove;h.css("background-position",-(q>>0)+"px "+(-(p>>0)+"px"))}D=setTimeout(function(){A.controlLoop()},30)};this.init2=function(b,d){G++;1===d&&(v=b);2===G&&this.init()};this.init=function(){b(".cloud-zoom-loading",f.parent()).remove();var e=b("<div class='mousetrap' style='background-image:url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)'></div>");
m=f.parent().append(e).find(":last");m=b(".mousetrap",f.parent());m.css({width:d.outerWidth(),height:d.outerHeight(),top:0,left:0,position:"absolute",zIndex:9999});m.bind("mousemove",this,function(b){B=b.pageX;C=b.pageY});m.bind("mouseleave",this,function(b){clearTimeout(D);k&&k.fadeOut(299);n&&n.fadeOut(299);l&&l.fadeOut(299);h.fadeOut(300,function(){A.fadedOut()});return!1});m.bind("mouseenter",this,function(g){B=g.pageX;C=g.pageY;H=g.data;h&&(h.stop(!0,!1),h.remove());g=c.adjustX;var e=c.adjustY,
p=d.outerWidth(),q=d.outerHeight(),w=c.zoomWidth,x=c.zoomHeight;"auto"==c.zoomWidth&&(w=p);"auto"==c.zoomHeight&&(x=q);var t=f.parent();switch(c.position){case "top":e-=x;break;case "right":g+=p;break;case "bottom":e+=q;break;case "left":g-=w;break;case "inside":w=p;x=q;break;default:t=b("#"+c.position),t.length?(w=t.innerWidth(),x=t.innerHeight()):(t=f,g+=p,e+=q)}h=t.append(u('<div id="cloud-zoom-big" class="cloud-zoom-big" style="display:none;position:absolute;left:%0px;top:%1px;width:%2px;height:%3px;background-image:url(\'%4\');z-index:99;"></div>',
g,e,w,x,v.src)).find(":last");h=b(".cloud-zoom-big",t);d.attr("title")&&c.showTitle&&(h.append(u('<div class="cloud-zoom-title">%0</div>',d.attr("title"))),b(".cloud-zoom-title",h).css("opacity",c.titleOpacity));b.browser.msie&&7>b.browser.version&&(r=b('<iframe frameborder="0" src="#"></iframe>').css({position:"absolute",left:g,top:e,zIndex:99,width:w,height:x}).insertBefore(h));h.fadeIn(500);k&&(k.remove(),k=null);y=d.outerWidth()/v.width*h.width();z=d.outerHeight()/v.height*h.height();k=f.append(u("<div class = 'cloud-zoom-lens' style='display:none;z-index:98;position:absolute;width:%0px;height:%1px;'></div>",
y,z)).find(":last");k=b(".cloud-zoom-lens",f);m.css("cursor",k.css("cursor"));g=!1;c.tint&&(k.css("background",'url("'+d.attr("src")+'")'),n=f.append(u('<div class="cloud-zoom-tint" style="display:none;position:absolute; left:0px; top:0px; width:%0px; height:%1px; background-color:%2;" />',d.outerWidth(),d.outerHeight(),c.tint)).find(":last"),n=b(".cloud-zoom-tint",f),n.css("opacity",c.tintOpacity),g=!0,n.fadeIn(500));c.softFocus&&(k.css("background",'url("'+d.attr("src")+'")'),f.append(u('<div class="cloud-zoom-soft" style="position:absolute;display:none;top:2px; left:2px; width:%0px; height:%1px;" />',
d.outerWidth()-2,d.outerHeight()-2,c.tint)),l=b(".cloud-zoom-soft",f),l.css("background",'url("'+d.attr("src")+'")'),l.css("opacity",.5),g=!0,l.fadeIn(500));g||k.css("opacity",c.lensOpacity);"inside"!==c.position&&k.fadeIn(500);H.controlLoop()})};e=new Image;b(e).load(function(){A.init2(this,0)});e.src=d.attr("src");e=new Image;b(e).load(function(){A.init2(this,1)});e.src=f.attr("href")}var r=document.getElementsByTagName("script"),J=r[r.length-1].src.lastIndexOf("/");r[r.length-1].src.slice(0,J);
b(document).ready(function(){b(".cloud-zoom, .cloud-zoom-gallery").CloudZoom()});b.fn.CloudZoom=function(f){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(c){}this.each(function(){var d,c;eval("var\ta = {"+b(this).attr("rel")+"}");d=a;b(this).is(".cloud-zoom")?(b(this).css({position:"relative",display:"block"}),b("img",b(this)).css({display:"block"}),"wrap"!=b(this).parent().attr("id")&&b(this).wrap('<div id="wrap" style="top:0px;z-index:9999;position:relative;"></div>'),c=b.extend({},
b.fn.CloudZoom.defaults,f),c=b.extend({},c,d),b(this).data("zoom",new I(b(this),c))):b(this).is(".cloud-zoom-gallery")&&(c=b.extend({},d,f),b(this).data("relOpts",c),b(this).bind("click",b(this),function(d){var c=d.data.data("relOpts"),f=d.data.data("relOpts").smallImage,e=b("#"+c.useZoom);$images=b("#"+c.useZoom+" img");$firstImage=$images.eq(0);c=!0;$firstImage.hasClass("visible")&&(c=!1);e.data("zoom").destroy();e.attr("href",d.data.attr("href"));if(c){var l=b('<img class="gallery-image" />');
l.attr("src",f);e.addClass("loading");$firstImage.remove();e.prepend(l);imagesLoaded(l,function(){e.removeClass("loading");$images.removeClass("visible");l.addClass("visible");e.CloudZoom()})}else $images.removeClass("visible"),$firstImage.attr("src",f),$firstImage.addClass("visible"),e.CloudZoom();return!1}))});return this};b.fn.CloudZoom.defaults={zoomWidth:"auto",zoomHeight:"auto",position:"right",tint:!1,tintOpacity:.5,lensOpacity:.5,softFocus:!1,smoothMove:3,showTitle:!0,titleOpacity:.5,adjustX:0,
adjustY:0}})(jQuery);